package vulnerability_exception

import (
	"config-service/handlers"
	"config-service/types"
	"config-service/utils/consts"

	"github.com/gin-gonic/gin"
)

func AddRoutes(g *gin.Engine) {
	queryParamsConfig := handlers.DefaultQueryConfig()
	queryParamsConfig.DefaultContext = "designators"
	queryParamsConfig.Params2Query["scope"] = handlers.QueryConfig{
		FieldName:   "designators",
		PathInArray: "attributes",
		IsArray:     true,
	}
	queryParamsConfig.Params2Query["designators"] = handlers.QueryConfig{
		FieldName:   "designators",
		PathInArray: "",
		IsArray:     true,
	}
	queryParamsConfig.Params2Query["vulnerabilities"] = handlers.QueryConfig{
		FieldName:   "vulnerabilities",
		PathInArray: "",
		IsArray:     true,
	}

	handlers.AddPolicyRoutes[*types.VulnerabilityExceptionPolicy](g,
		consts.VulnerabilityExceptionPolicyPath,
		consts.VulnerabilityExceptionPolicyCollection, queryParamsConfig)
}
